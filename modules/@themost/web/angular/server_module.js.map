{"version":3,"sources":["server_module.es6"],"names":["AngularServerModule","name","ctor","ng","angular","jQuery","createDocument","s","window","createWindow","setTimeout","clearTimeout","Object","defineProperty","document","get","configurable","enumerable","location","href","global","Error","ext","require","extend","element","parentWindow","$","init","app","module","directive","directives","service","services","filter","filters","controller","controllers","navigator","appCodeName","appVersion","cookieEnabled","hardwareConcurrency","language","platform","product","userAgent","exports"],"mappings":"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","file":"server_module.js","sourcesContent":["/**\n * @license\n * MOST Web Framework 2.0 Codename Blueshift\n * Copyright (c) 2014, Kyriakos Barbounakis k.barbounakis@gmail.com\n *                     Anthi Oikonomou anthioikonomou@gmail.com\n *\n * Use of this source code is governed by an BSD-3-Clause license that can be\n * found in the LICENSE file at https://themost.io/license\n */\n'use strict';\n\nimport domino from 'domino';\n\n/**\n * @class\n * @property {*} directives\n * @property {*} controllers\n * @property {*} filters\n * @property {*} services\n * @private\n */\nclass AngularServerModule {\n    /**\n     * @param {string} name\n     * @param {function|Array|*=} ctor\n     * @returns AngularServerModule|function\n     */\n    service(name, ctor) { }\n\n    /**\n     * @param {string} name\n     * @param {function|Array|*=} ctor\n     * @returns AngularServerModule|function\n     */\n    directive(name, ctor) { }\n\n    /**\n     * @param {string} name\n     * @param {function|Array|*=} ctor\n     * @returns AngularServerModule|function\n     */\n    filter(name, ctor) { }\n\n    /**\n     * @param {string} name\n     * @param {function|Array|*=} ctor\n     * @returns AngularServerModule|function\n     */\n    controller(name, ctor) { }\n}\n\nconst ng = {\n    /**\n     * @function\n     */\n    angular: null,\n    /**\n     * @function\n     */\n    jQuery: null,\n    /**\n     * @param {string=} s\n     * @returns {HTMLDocument}\n     */\n    createDocument: function(s) {\n        s = s || '<html/>';\n        const window = domino.createWindow(s);\n        window.setTimeout = setTimeout;\n        window.clearTimeout = clearTimeout;\n        //define parent window property\n        Object.defineProperty(window.document, 'parentWindow', { get: function(){\n            return window;\n        }, configurable:false, enumerable:false });\n        window.location.href = \"/\";\n        if (typeof global.jQuery !== 'function')\n            throw new Error('jQuery object cannot be instantiated due to missing constructor.');\n        global.jQuery(window);\n        //extend jQuery\n        const ext = require('./../jquery/server_extensions');\n        ext.extend(window.jQuery);\n        if (typeof global.angular !== 'function')\n            throw new Error('Angular JS object cannot be instantiated due to missing constructor.');\n        //initialize angular\n        global.angular(window, window.document);\n        /**\n         * @param {string|*} s\n         * @returns {HTMLElement|*}\n         */\n        window.document.element = function(s) {\n            return this.parentWindow.$(s);\n        };\n        return window.document;\n    },\n    /**\n     * @param {*} app\n     */\n    init: function (app) {\n        if (typeof app.module === 'undefined' || app.module===null) {\n\n            /**\n             * @function\n             * @memberof HttpApplication\n             * @param {string=} s\n             * @returns {HTMLDocument}\n             */\n            app.document = ng.createDocument;\n            /**\n             * @type {{directive: directive, directives: {}, service: service, services: {}, filter: filter, filters: {}, controller: controller, controllers: {}}}\n             * @memberOf HttpApplication\n             */\n            app.module = {\n                /**\n                 * @param {string} name\n                 * @param {function=} ctor\n                 * @returns {*}\n                 */\n                directive: function(name, ctor) {\n                    if (typeof ctor === 'undefined')\n                        return this.directives[name];\n                    this.directives[name] = ctor;\n                    return this;\n                },\n                directives: {},\n                /**\n                 * @param {string} name\n                 * @param {function=} ctor\n                 * @returns {*}\n                 */\n                service: function(name, ctor) {\n                    if (typeof ctor === 'undefined')\n                        return this.services[name];\n                    this.services[name] = ctor;\n                    return this;\n                },\n                services: {},\n                /**\n                 * @param {string} name\n                 * @param {function=} ctor\n                 * @returns {*}\n                 */\n                filter: function(name, ctor) {\n                    if (typeof ctor === 'undefined')\n                        return this.filters[name];\n                    this.filters[name] = ctor;\n                    return this;\n                },\n                filters:{},\n                /**\n                 * @param {string} name\n                 * @param {function=} ctor\n                 * @returns {*}\n                 */\n                controller: function(name, ctor) {\n                    if (typeof ctor === 'undefined')\n                        return this.controllers[name];\n                    this.controllers[name] = ctor;\n                    return this;\n                },\n                controllers:{}\n            }\n        }\n    }\n};\n\nif (typeof ng.angular === 'undefined' || ng.angular=== null) {\n    global.window = domino.createWindow('<html />');\n    global.window.location.href = \"/\";\n    global.document = global.window.document;\n    global.navigator = { appCodeName:\"Mozilla\",\n        appVersion:\"AppleWebKit/537.36 (KHTML, like Gecko) Chrome/37.0.2062.124 Safari/537.36\",\n        cookieEnabled: false,\n        hardwareConcurrency:4,\n        language:\"en-US\",\n        platform:\"Win32\",\n        product:\"Gecko\",\n        userAgent:\"Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/37.0.2062.124 Safari/537.36\"\n    };\n    //call jQuery initialization\n    require('./../jquery/jquery');\n    //call angular initialization\n    require('./angular');\n    //delete dummy property\n    delete global.window;\n    delete global.document;\n    //set methods\n    ng.angular = global.angular;\n    ng.jQuery = global.jQuery;\n}\nmodule.exports = ng;\n"]}